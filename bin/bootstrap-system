#!/usr/bin/env bash

exists () {
    command -v "$1" &> /dev/null;
}

# Ubuntu debs
echo -n "- Checking Ubuntu packages"
if uname -v | grep -q Ubuntu; then
    echo ", will install"
    # TODO Check ip packages already installed
    sudo apt install \
        build-essential \
        curl \
        direnv \
        golang-go \
        htop \
        jq \
        keepassx \
        libssl-dev \
        manpages-dev \
        nmap \
        pkg-config \
        ripgrep \
        shellcheck \
        tmux \
        vim \
        xclip \
        yadm \

else
    echo ", not on Ubuntu, skipping"
fi

# Rust
echo -n "- Checking rust"
if ! exists rustup; then
    echo ", missing, will install"
    curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh
    . "$HOME/.cargo/env"
else
    echo ", already exist"
fi

# Rust utils
for crate in \
    cargo-watch \
    enw \
    simple-http-server
do
    echo -n "- Checking $crate"
    if ! exists "$crate"; then
        echo ", missing, will install"
        cargo install "$crate"
    else
        echo ", already exist"
    fi
done

